<!DOCTYPE html>
<html>
<head>
  <title></title>
</head>
<body ng-app="myApp">
    {{1+1}}



<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.8/angular.js"></script>
<script src="https://unpkg.com/angular-ui-router/release/angular-ui-router.min.js"></script>
    <a ui-sref="profiles">profiles (main state)</a>
<ui-view></ui-view>
<script>
      let app = angular.module('myApp', ['ui.router']);

  app.config(function($stateProvider) {
    $stateProvider.state('profiles', {
      url: 'profiles',
      template: `<profiles/>`,
    });
    
    $stateProvider.state('profile', {
      parent: 'profiles',
      url: '/:profileId',
      template: `<users profile-id="profileId"/>`,
      controller: function($stateParams, $scope) {
        $scope.profileId = $stateParams.profileId;
      }
    });

    $stateProvider.state('user', {
      parent: 'profile',
      url: '/user/:userId',
      template: `<user user-id="userId"></user>`,
      controller: function($stateParams, $scope) {
        $scope.userId = $stateParams.userId;
      }
    });

  });

  app.component('profiles', {
      template: `<h1>PROFILES</h1>
    <a ui-sref="profile({profileId:1})">profile1</a><br/>
    <a ui-sref="profile({profileId:2})">profile2</a><br/>
    <a ui-sref="profile({profileId:3})">profile3</a><br/>
    <br/><br/><br/><ui-view></ui-view>`
    })
    .component('users', {
      bindings: {
        profileId: '<',
      },
      template: `<a ui-sref="user({userId: user})" ng-repeat="user in $ctrl.users[$ctrl.profileId]">User {{user}}</a>
      <br/><br/><br/><ui-view></ui-view>`,
      controller: function() {
        this.users = {
          1: [1,2,3],
          2: [4,5,6],
          3: [7,8,9]
        }
      }
    })
    .component('user', {
      bindings: {
        userId: '<',
      },
      template: `<h1>USER {{$ctrl.userId}}</h1>`,
    })


    </script>

</body>
</html>